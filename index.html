<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SUPORTE-N2</title>
  <meta name="theme-color" content="#0B021D"/>
  <meta name="description" content="Aplicativo de acompanhamento de metas para Suporte N2."/>

  <link rel="apple-touch-icon" href="icon-192x192.png">
  <link rel="manifest" href="manifest.json">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jsPDF para exportar PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="toast-container"></div>

  <div class="page-container">
    <div class="header-metas">
      <img src="logo.png" alt="Logo" class="header-logo" />
      <h1 id="main-title" data-editable="true">Suporte N2</h1>
      <button id="settings-button" title="Configurar Metas">
        <!-- ícone settings -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 ..." />
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
      </button>
    </div>

    <div class="tabs-container" id="tabs-container">
      <button class="tab-button active" data-tab="principal">Principal</button>
      <button class="tab-button" data-tab="cancelamentos">Cancelamentos</button>
      <button class="tab-button" data-tab="outros">Outros</button>
      <button class="tab-button" data-tab="relatorios">Relatórios</button>
    </div>

    <div id="tab-content-wrapper">
      <!-- TAB Principal -->
      <section id="tab-principal" class="tab-content active">
        <div class="metas-grid">
          <!-- HISTÓRICO DE CASOS -->
          <div class="meta-card">
            <div class="card-header">
              <h2 id="title-casos" data-editable="true">Histórico de Casos</h2>
              <p id="subtitle-casos" data-editable="true">Pesquise e gere os seus casos.</p>
            </div>
            <div class="card-body">
              <div class="case-controls">
                <input type="search" id="case-search-input" placeholder="Pesquisar..." />
                <div class="filter-buttons-group" role="tablist" aria-label="Filtros">
                  <button type="button" class="button filter-btn active" data-filter="Todos">Todos</button>
                  <button type="button" class="button filter-btn" data-filter="Pendente">Pendentes</button>
                  <button type="button" class="button filter-btn" data-filter="Em-Andamento">Em-Andamento</button>
                  <button type="button" class="button filter-btn" data-filter="Resolvido">Resolvidos</button>
                </div>
              </div>
              <div id="cases-list-container"></div>
            </div>
            <div class="card-footer">
              <button type="button" id="addCaseButton" class="button secondary-button">+ Adicionar</button>
              <button type="button" id="clearCasesButton" class="button reset-button">Limpar</button>
              <button type="button" id="saveCasesButton" class="button save-button">Salvar Casos</button>
            </div>
          </div>

          <!-- CONTADORES (Categoria acima agora) -->
          <div class="meta-card">
            <div class="card-header"><h2 id="title-atendimentos" data-editable="true">Contadores</h2><p id="subtitle-atendimentos" data-editable="true">Acompanhe seu progresso.</p></div>
            <div class="card-body">
              <div class="form-group">
                <label id="label-category-top" for="categorySelectTop" data-editable="true">Categoria do Cancelamento:</label>
                <select id="categorySelectTop">
                  <option>Sem Sinal</option>
                  <option>Massivo</option>
                  <option>Lentidão</option>
                  <option>Quedas de Conexão</option>
                  <option>Outros</option>
                </select>
              </div>

              <div class="daily-counters-row">
                <div class="form-group">
                  <label id="label-protocolos" for="protocolosAnalisadosInput" data-editable="true">Protocolos (Dia):</label>
                  <div class="input-with-button-container">
                    <input type="number" id="protocolosAnalisadosInput" placeholder="0" min="0" />
                    <button type="button" id="incrementProtocolosButton" class="button" style="width:70px">+1</button>
                  </div>
                </div>

                <div class="form-group">
                  <label id="label-daily-cancellations" for="dailyCancellationsInput" data-editable="true">Cancelamentos (Dia):</label>
                  <input type="number" id="dailyCancellationsInput" placeholder="0" min="0" />
                </div>
              </div>

              <div class="form-group">
                <label id="label-atendimentos" for="atendimentosInput" data-editable="true">Total de Cancelamentos (Mês):</label>
                <input type="number" id="atendimentosInput" placeholder="0" min="0" />
              </div>

              <div id="protocol-goals-container" style="margin-top:15px;"></div>
              <div id="metas-container"></div>

              <div id="summary-text" class="summary-box">A aguardar os seus dados...</div>
            </div>
          </div>

          <!-- RESPOSTAS RÁPIDAS -->
          <div class="meta-card">
            <div class="card-header">
              <h2 id="title-respostas" data-editable="true">Respostas Rápidas</h2>
              <p id="subtitle-respostas" data-editable="true">Clique numa resposta para copiar o texto completo.</p>
            </div>
            <div class="card-body" id="respostas-container">
              <!-- respostas (igual ao original) -->
              <div id="resposta-1" class="summary-box resposta-copiavel" data-full-text="Olá...">Visita cancelada por falha externa. Equipa a atuar na correção.</div>
              <div id="resposta-2" class="summary-box resposta-copiavel" data-full-text="Olá...">Oportunidade de melhoria na conexão sem custo. Agende a atualização.</div>
              <div id="resposta-3" class="summary-box resposta-copiavel" data-full-text="Olá...">Problema resolvido remotamente. Confirme se a internet normalizou.</div>
            </div>
          </div>

          <!-- MISSÃO DIÁRIA -->
          <div class="meta-card">
            <div class="card-header"><h2 id="title-daily-mission" data-editable="true">Missão Diária</h2><p id="subtitle-daily-mission" data-editable="true">Objetivos do dia.</p></div>
            <div class="card-body"><ul id="daily-mission-list"></ul></div>
          </div>

          <!-- RESUMO DO DIA -->
          <div class="meta-card">
            <div class="card-header"><h2 data-editable="true">Resumo do Dia</h2><p data-editable="true">Anotações e casos do dia.</p></div>
            <div class="card-body">
              <h4>Anotações de Bordo:</h4>
              <textarea id="daily-summary-textarea" placeholder="Escreva suas anotações..."></textarea>
              <h4 style="margin-top:15px">Casos do Dia:</h4>
              <div id="daily-summary-cases-list"></div>
            </div>
            <div class="card-footer">
              <button type="button" id="dailySummaryClearButton" class="button reset-button">Limpar Anotação (e Casos do Dia)</button>
              <button type="button" id="dailySummarySaveButton" class="button save-button">Salvar</button>
            </div>
          </div>

        </div>
      </section>

      <!-- TAB Cancelamentos -->
      <section id="tab-cancelamentos" class="tab-content">
        <div class="metas-grid">
          <!-- DIÁRIO DE BORDO -->
          <div class="meta-card">
            <div class="card-header"><h2 id="title-logbook" data-editable="true">Diário de Bordo</h2><p id="subtitle-logbook" data-editable="true">Anote eventos importantes.</p></div>
            <div class="card-body">
              <textarea id="logbook-textarea" placeholder="Ex: Instabilidade massiva..."></textarea>
            </div>
            <div class="card-footer">
              <button type="button" id="saveLogbookButton" class="button save-button">Salvar Anotação</button>
            </div>
          </div>

          <!-- HISTÓRICO DE ENTRADAS -->
          <div class="meta-card">
            <div class="card-header"><h2 id="title-historico" data-editable="true">Histórico de Entradas</h2></div>
            <div class="card-body"><ul id="history-list"></ul></div>
          </div>

          <!-- PROJEÇÃO -->
          <div class="meta-card">
            <div class="card-header"><h2 id="title-projecao" data-editable="true">Projeção de Cancelamentos</h2></div>
            <div class="card-body" style="text-align:center;">
              <div id="projection-value" class="projection-value" style="font-size:1.6rem; color: var(--warning-color);">0</div>
              <div id="projection-formula" style="margin-bottom:12px;">A aguardar histórico...</div>
              <div id="tier-projection-container" class="tier-container" style="display:flex;flex-direction:column;gap:10px;"></div>
            </div>
          </div>

          <!-- RESUMO CATEGORIA -->
          <div class="meta-card">
            <div class="card-header"><h2 id="title-resumo-categoria" data-editable="true">Resumo por Categoria</h2></div>
            <div class="card-body">
              <div id="category-chart-container"><canvas id="categoryPieChart"></canvas></div>
              <ul id="category-summary-list" style="margin-top:15px;"></ul>
            </div>
          </div>

          <!-- GRÁFICO -->
          <div class="meta-card">
            <div class="card-header"><h2 id="title-grafico" data-editable="true">Gráfico de Tendência</h2></div>
            <div class="card-body"><div id="chart-container"><canvas id="trendChart"></canvas></div></div>
          </div>

        </div>
      </section>

      <!-- TAB Outros -->
      <section id="tab-outros" class="tab-content">
        <div class="metas-grid">
          <!-- LINKS -->
          <div class="meta-card">
            <div class="card-header">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px">
                <h2 id="title-links" data-editable="true">Links Úteis</h2>
                <button id="senhas-button" class="icon-button" title="Ver Senhas">🔐</button>
              </div>
              <p id="subtitle-links" data-editable="true">Aceda a sistemas importantes.</p>
            </div>
            <div class="card-body" id="links-uteis-container-body">
              <div id="links-uteis-container">
                <a href="http://172.30.0.141:8080" class="link-util" target="_blank">SIG</a>
                <a href="https://desktopsa.my.salesforce.com" class="link-util" target="_blank">SalesForce</a>
                <a href="https://webmail.desktop.com.br" class="link-util" target="_blank">WebMail</a>
              </div>
            </div>
          </div>

          <!-- COMISSÃO -->
          <div class="meta-card">
            <div class="card-header"><h2 id="title-comissao" data-editable="true">Comissão Estimada</h2></div>
            <div class="card-body" style="text-align:center;">
              <div id="bonus-value" class="bonus-value" style="color: var(--success-color);">R$ 0,00</div>
              <div id="bonus-formula">A aguardar dados...</div>
            </div>
          </div>

          <!-- SENHAS -->
          <div class="meta-card">
            <div class="card-header"><h2 id="title-conquistas" data-editable="true">Senhas</h2></div>
            <div class="card-body">
              <div id="senhas-container"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- TAB Relatórios -->
      <section id="tab-relatorios" class="tab-content">
        <div class="metas-grid">
          <div class="meta-card" style="grid-column:1/-1">
            <div class="card-header">
              <h2>Relatórios Avançados</h2>
              <p>Visão mensal, comparação e exportação em PDF.</p>
            </div>
            <div class="card-body">
              <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center">
                <label for="report-month">Mês:</label>
                <input type="month" id="report-month" />
                <button id="generateReportBtn" class="button">Gerar Resumo Mensal</button>
                <button id="compareMonthsBtn" class="button">Comparar com Mês Anterior</button>
                <button id="exportPdfBtn" class="button save-button">Exportar para PDF</button>
              </div>

              <div id="report-output" style="margin-top:20px"></div>
            </div>
          </div>
        </div>
      </section>

    </div>

    <div class="action-buttons">
      <button id="saveButton" class="button save-button">Guardar Progresso</button>
      <button id="editButton" class="button secondary-button">✏️ Editar Textos</button>
      <button id="themeToggleButton" class="button">Mudar Tema</button>
      <button id="notifyButton" class="button">🔔 Ativar Notificações</button>
    </div>
  </div>

  <footer class="app-footer">
    <a href="https://www.flavioitech.com" target="_blank" class="footer-link">
      <img src="icon-192x192.png" alt="Logo" class="footer-logo" />
      <span id="footer-site-text" data-editable="true">Meu Site</span>
    </a>
    <a href="https://wa.me/5519998821845" target="_blank" class="footer-link">
      <span id="footer-whatsapp-text" data-editable="true">19 99882-1845</span>
    </a>
  </footer>

  <!-- Modais (simples placeholders - o script cria o conteúdo dinâmico) -->
  <div id="settings-modal" class="modal" aria-hidden="true"></div>
  <div id="senhas-modal" class="modal" aria-hidden="true"></div>

  <script type="module" src="script.js"></script>
</body>
</html>
