<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suporte N2</title>
    <meta name="theme-color" content="#0B021D"/>
    <meta name="description" content="Aplicativo de acompanhamento de metas para Suporte N2."/>
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">

    <!-- Bibliotecas para Gr√°ficos e PDF -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- Overlay de Carregamento -->
    <div id="loading-overlay">
        <div class="spinner"></div>
        <p>A carregar...</p>
    </div>
    
    <div id="toast-container"></div>

    <!-- Conte√∫do Principal do App -->
    <div id="app-container" class="page-container" style="visibility: hidden;">
        <!-- Header -->
        <div class="header-metas">
            <img src="logo.png" alt="Logo" class="header-logo">
            <h1 id="main-title" data-editable="true">Suporte N2</h1>
            <button id="settings-button" title="Configurar Metas">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2.82l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2.82l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            </button>
        </div>
        
        <!-- Abas de Navega√ß√£o -->
        <div class="tabs-container">
            <button class="tab-button active" data-tab="principal">Principal</button>
            <button class="tab-button" data-tab="cancelamentos">Cancelamentos</button>
            <button class="tab-button" data-tab="relatorios">Relat√≥rios</button>
            <button class="tab-button" data-tab="outros">Outros</button>
        </div>
        
        <!-- Conte√∫do das Abas -->
        <div id="tab-content-wrapper">
            <!-- Aba Principal -->
            <div id="tab-principal" class="tab-content active">
                <div class="metas-grid">
                    
                    <div class="meta-card">
                        <div class="card-header">
                            <h2 id="title-casos" data-editable="true">Hist√≥rico de Casos</h2>
                            <p id="subtitle-casos" data-editable="true">Pesquise e gira os seus casos.</p>
                        </div>
                        <div class="card-body">
                            <div class="case-controls">
                                <input type="search" id="case-search-input" placeholder="Pesquisar...">
                                <div class="filter-buttons-group">
                                    <button type="button" class="button filter-btn active" data-filter="all">Todos</button>
                                    <button type="button" class="button filter-btn" data-filter="Pendente">Pendentes</button>
                                    <button type="button" class="button filter-btn" data-filter="Resolvido">Resolvidos</button>
                                </div>
                            </div>
                            <div id="cases-list-container"></div>
                        </div>
                        <div class="card-footer">
                            <button type="button" id="addCaseButton" class="button secondary-button">+ Adicionar</button>
                            <button type="button" id="clearCasesButton" class="button reset-button">Limpar</button>
                        </div>
                    </div>
                    
                    <div class="meta-card">
                        <div class="card-header">
                            <h2 id="title-atendimentos" data-editable="true">Contadores</h2>
                            <p id="subtitle-atendimentos" data-editable="true">Acompanhe o seu progresso para a comiss√£o.</p>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label id="label-category" for="categorySelect" data-editable="true">Categoria do Cancelamento:</label>
                                <div class="input-with-button-container">
                                    <select id="categorySelect">
                                        <option id="category-option-1" data-editable="true">Sem Sinal</option>
                                        <option id="category-option-2" data-editable="true">Massivo</option>
                                        <option id="category-option-3" data-editable="true">Lentid√£o</option>
                                        <option id="category-option-4" data-editable="true">Quedas de Conex√£o</option>
                                        <option id="category-option-5" data-editable="true">Outros</option>
                                    </select>
                                    <button type="button" id="incrementButton" class="button" style="width: 70px;">+1</button>
                                </div>
                            </div>
                            <div class="daily-counters-row">
                                <div class="form-group">
                                    <label id="label-protocolos" for="protocolosAnalisadosInput" data-editable="true">Protocolos (Dia):</label>
                                    <div class="input-with-button-container">
                                        <input type="number" id="protocolosAnalisadosInput" placeholder="0">
                                        <button type="button" id="incrementProtocolosButton" class="button" style="width: 70px;">+1</button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label id="label-daily-cancellations" for="dailyCancellationsInput" data-editable="true">Cancelamentos (Dia):</label>
                                    <input type="number" id="dailyCancellationsInput" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label id="label-atendimentos" for="atendimentosInput" data-editable="true">Total de Cancelamentos (M√™s):</label>
                                <input type="number" id="atendimentosInput" placeholder="0">
                            </div>
                            <div id="protocol-goals-container" style="margin-top: 15px;"></div>
                            <div id="metas-container"></div>
                            <div id="summary-text" class="summary-box">A aguardar os seus dados...</div>
                        </div>
                    </div>
                    
                    <div class="meta-card">
                        <div class="card-header">
                            <h2 id="title-respostas" data-editable="true">Respostas R√°pidas</h2>
                            <p id="subtitle-respostas" data-editable="true">Clique numa resposta para copiar o texto completo.</p>
                        </div>
                        <div class="card-body" id="respostas-container">
                            <div id="resposta-1" class="summary-box resposta-copiavel" data-full-text="Ol√°, &#10;&#10;Aqui √© Fl√°vio, da empresa Desktop. Tudo bem com voc√™?&#10;&#10;Quero te explicar sobre o reparo que estava agendado (protocolo [ XXXX ]): identificamos que a falha n√£o est√° na sua resid√™ncia, mas sim em um equipamento externo que leva o sinal at√© a√≠.&#10;&#10;Por isso, a visita t√©cnica n√£o seria eficaz e precisou ser cancelada.&#10;&#10;Mas n√£o se preocupe! Nossa equipe j√° est√° cuidando disso e em breve voc√™ ter√° seu servi√ßo restabelecido.&#10;&#10;Conte sempre com a Desktop. Estamos juntos para garantir sua melhor experi√™ncia!">Visita cancelada por falha externa. Equipa a atuar na corre√ß√£o.</div>
                            <div id="resposta-2" class="summary-box resposta-copiavel" data-full-text="Ol√°, cliente Desktop!&#10;&#10;Meu nome √© Fl√°vio do Suporte T√©cnico N2 e estou entrando em contato com uma novidade incr√≠vel: identificamos uma oportunidade de melhorar ainda mais a qualidade da sua conex√£o com a Desktop ‚Äî e o melhor, sem custo adicional!&#10;&#10;Nosso time t√©cnico acompanha de perto o desempenho dos nossos clientes e notamos que uma atualiza√ß√£o no seu equipamento pode proporcionar uma experi√™ncia ainda melhor.&#10;&#10;√â s√≥ me informar a melhor data e hor√°rio, e cuidamos do resto!&#10;&#10;Fico no aguardo da sua resposta.&#10;&#10;At√© mais!&#10;Fl√°vio N2&#10;Equipe Desktop">Oportunidade de melhoria na conex√£o sem custo. Agende a atualiza√ß√£o.</div>
                            <div id="resposta-3" class="summary-box resposta-copiavel" data-full-text="Ol√°, cliente TOP!&#10;&#10;Sou o Fl√°vio do Suporte T√©cnico N2, da empresa DESKTOP INTERNET!&#10;&#10;O motivo do nosso contato, √© referente ao problema protocolo [ XXXX ] que estava causando falta de acesso √† sua internet.&#10;Foi feita uma atualiza√ß√£o e corre√ß√£o via sistema. Conseguimos resolver remotamente o seu problema.&#10;Poderia nos informar se a sua internet normalizou e se podemos cancelar sua visita?&#10;&#10;Seu protocolo de agendamento √©: &#10;&#10;Se ainda estiver com problemas, a visita com o t√©cnico no local ser√° mantida para valida√ß√£o.">Problema resolvido remotamente. Confirme se a internet normalizou.</div>
                            <div id="resposta-4" class="summary-box resposta-copiavel" data-full-text="Nesse caso vamos ter que prosseguir com a visita t√©cnica Ok">Vamos prosseguir com a visita t√©cnica para resolver o problema.</div>
                            <div id="resposta-5" class="summary-box resposta-copiavel" data-full-text="A equipe N2 do suporte t√©cnico da Desktop agradece e tudo de bom !">A equipa N2 da Desktop agradece. Tenha um √≥timo dia!</div>
                            <div id="resposta-6" class="summary-box resposta-copiavel" data-full-text="Frase reserva">Frase de reserva para uso geral em atendimentos.</div>
                        </div>
                    </div>
                    
                    <div class="meta-card">
                        <div class="card-header">
                            <h2 id="title-daily-mission" data-editable="true">Miss√£o Di√°ria</h2>
                            <p id="subtitle-daily-mission" data-editable="true">Os seus objetivos para hoje.</p>
                        </div>
                        <div class="card-body">
                            <ul id="daily-mission-list"></ul>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-cancelamentos" class="tab-content">
                <div class="metas-grid">
                    <div class="meta-card">
                        <div class="card-header">
                            <h2 id="title-logbook" data-editable="true">Di√°rio de Bordo</h2>
                            <p id="subtitle-logbook" data-editable="true">Anote eventos importantes do dia.</p>
                        </div>
                        <div class="card-body">
                            <textarea id="logbook-textarea" placeholder="Ex: Instabilidade massiva na regi√£o X..."></textarea>
                        </div>
                        <div class="card-footer">
                            <button type="button" id="saveLogbookButton" class="button save-button">Salvar Anota√ß√£o</button>
                        </div>
                    </div>
                    <div class="meta-card">
                        <div class="card-header"><h2 id="title-historico" data-editable="true">Hist√≥rico de Entradas</h2></div>
                        <div class="card-body">
                            <ul id="history-list"></ul>
                        </div>
                    </div>
                    <div class="meta-card">
                        <div class="card-header"><h2 id="title-projecao" data-editable="true">Proje√ß√£o de Cancelamentos</h2></div>
                        <div class="card-body" style="justify-content: center; align-items: center; text-align: center;">
                            <div id="projection-value" class="projection-value">0</div>
                            <div id="projection-formula">A aguardar hist√≥rico...</div>
                            <div id="tier-projection-container"></div>
                        </div>
                    </div>
                    <div class="meta-card">
                        <div class="card-header"><h2 id="title-resumo-categoria" data-editable="true">Resumo por Categoria</h2></div>
                        <div class="card-body">
                            <div id="category-chart-container">
                                <canvas id="categoryPieChart"></canvas>
                            </div>
                            <ul id="category-summary-list" style="margin-top: 15px;"></ul>
                        </div>
                    </div>
                    <div class="meta-card">
                        <div class="card-header"><h2 id="title-grafico" data-editable="true">Gr√°fico de Tend√™ncia</h2></div>
                        <div class="card-body">
                            <div id="chart-container"><canvas id="trendChart"></canvas></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-relatorios" class="tab-content">
                <div class="metas-grid">
                    <div class="meta-card" id="report-card">
                        <div class="card-header">
                            <h2 data-editable="true">Relat√≥rio de Desempenho</h2>
                            <div class="report-controls">
                                <select id="report-month-select"></select>
                                <button id="export-pdf-button" class="button">Exportar PDF</button>
                            </div>
                        </div>
                        <div class="card-body report-body">
                            <div class="report-section">
                                <h3 id="current-month-title">Resumo do M√™s</h3>
                                <div id="current-month-summary" class="summary-grid"></div>
                            </div>
                            <div class="report-section">
                                <h3 id="previous-month-title">Comparativo</h3>
                                <div id="previous-month-comparison" class="summary-grid"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="tab-outros" class="tab-content">
                <div class="metas-grid">
                    <div class="meta-card">
                        <div class="card-header">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                                <h2 id="title-links" data-editable="true">Links √öteis</h2>
                                <button id="senhas-button" title="Ver Senhas" class="icon-button">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/></svg>
                                </button>
                            </div>
                            <p id="subtitle-links" data-editable="true">Aceda a sistemas importantes com um clique.</p>
                        </div>
                        <div class="card-body" id="links-uteis-container-body">
                            <div id="links-uteis-container">
                                <a href="http://172.30.0.141:8080" target="_blank" class="link-util" id="link-text-1" data-editable="true">SIG</a>
                                <a href="http://172.30.0.141:8080/oportunidades" target="_blank" class="link-util" id="link-text-2" data-editable="true">SIG - Oportunidades</a>
                                <a href="https://172.30.0.141" target="_blank" class="link-util" id="link-text-3" data-editable="true">Deskpedia</a>
                                <a href="https://desktopsa.my.salesforce.com" target="_blank" class="link-util" id="link-text-4" data-editable="true">SalesForce</a>
                                <a href="https://desktop.matrixdobrasil.ai/Painel/login" target="_blank" class="link-util" id="link-text-5" data-editable="true">Matrix Chat</a>
                                <a href="http://sis.desktop.com.br" target="_blank" class="link-util" id="link-text-6" data-editable="true">SIS</a>
                                <a href="https://adm.desktop.com.br" target="_blank" class="link-util" id="link-text-7" data-editable="true">ADM</a>
                                <a href="https://login.lg.com.br/login/desktop" target="_blank" class="link-util" id="link-text-8" data-editable="true">LG</a>
                                <a href="https://webmail.desktop.com.br" target="_blank" class="link-util" id="link-text-9" data-editable="true">WebMail</a>
                                <a href="https://netcore.desktop.localdomain/weboss/reprovisiona_gpon" target="_blank" class="link-util" id="link-text-10" data-editable="true">NetCore</a>
                                <a href="https://desktopcombr.sharepoint.com/sites/EQUIPEDEPROCESSOS/repositorio_materiais/SitePages/LearningTeamHome.aspx" target="_blank" class="link-util" id="link-text-11" data-editable="true">Novo Pulpo</a>
                                <a href="https://docs.google.com/spreadsheets/d/1zkNxgYOs8iWMSwdgtwV4-g0RxmkoI_jgdclkpGjF3Rc/edit#gid=0" target="_blank" class="link-util" id="link-text-12" data-editable="true">Cancelados COP</a>
                                <a href="https://desktopcombr.sharepoint.com/:p:/r/sites/EQUIPEDEPROCESSOS/repositorio_materiais/_layouts/15/doc2.aspx?sourcedoc=%7BE78AE514-642A-4F46-8FBB-2C54C51C9945%7D&file=MODELOS%20DE%20EQUIPAMENTOS.pptx&action=edit&mobileredirect=true" target="_blank" class="link-util" id="link-text-13" data-editable="true">Modelos de Roteadores</a>
                                <a href="https://www.flavioitech.com" target="_blank" class="link-util" id="link-text-14" data-editable="true">Meu Site</a>
                            </div>
                        </div>
                    </div>
                    <div class="meta-card">
                        <div class="card-header"><h2 id="title-comissao" data-editable="true">Comiss√£o Estimada</h2></div>
                        <div class="card-body" style="justify-content: center; align-items: center;">
                            <div id="bonus-value" class="bonus-value" style="color: var(--success-color);">R$ 0,00</div>
                            <div id="bonus-formula">A aguardar dados...</div>
                        </div>
                    </div>
                    <div class="meta-card">
                        <div class="card-header"><h2 id="title-conquistas" data-editable="true">Conquistas üèÜ</h2></div>
                        <div class="card-body">
                            <ul id="achievement-list">
                                <li id="achieve-first-save" class="achievement">Sincronizar pela primeira vez.</li>
                                <li id="achieve-bonus1" class="achievement">Atingir a primeira faixa de comiss√£o.</li>
                                <li id="achieve-max-bonus" class="achievement">Atingir a meta m√°xima pela primeira vez.</li>
                                <li id="achieve-100-cancellations" class="achievement">Atingir 100 cancelamentos no m√™s.</li>
                                <li id="achieve-200-cancellations" class="achievement">Atingir 200 cancelamentos no m√™s.</li>
                                <li id="achieve-5day-streak" class="achievement">Sincronizar por 5 dias seguidos.</li>
                                <li id="achieve-10-day-streak" class="achievement">Sincronizar por 10 dias seguidos.</li>
                                <li id="achieve-30-days" class="achievement">Sincronizar em 30 dias diferentes.</li>
                                <li id="achieve-first-case" class="achievement">Adicionar o seu primeiro caso.</li>
                                <li id="achieve-10-cases" class="achievement">Registar 10 casos na lista.</li>
                                <li id="achieve-25-cases" class="achievement">Registar 25 casos na lista.</li>
                                <li id="achieve-all-status" class="achievement">Utilizar todos os 3 status de caso.</li>
                                <li id="achieve-all-categories" class="achievement">Utilizar 5 categorias diferentes.</li>
                                <li id="achieve-copy-response" class="achievement">Copiar uma resposta r√°pida pela primeira vez.</li>
                                <li id="achieve-use-all-quick-responses" class="achievement">Utilizar todas as respostas r√°pidas.</li>
                                <li id="achieve-customize" class="achievement">Personalizar os textos da aplica√ß√£o.</li>
                                <li id="achieve-change-theme" class="achievement">Personalizar o visual com um novo tema.</li>
                                <li id="achieve-export" class="achievement">Fazer o primeiro backup dos seus dados.</li>
                                <li id="achieve-50-protocols" class="achievement">Analisar 50 protocolos num dia.</li>
                                <li id="achieve-monthly-protocol-goal" class="achievement">Atingir a meta mensal de 1300 protocolos.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button type="button" id="saveButton" class="button save-button">Sincronizar com a Nuvem</button>
            <button type="button" id="editButton" class="button secondary-button">‚úèÔ∏è Editar Textos</button>
            <button type="button" id="themeToggleButton" class="button">Mudar Tema</button>
        </div>
    </div>
    
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="title-modal-config" data-editable="true">Configurar Metas e Alertas</h2>
                <span class="close-button" id="close-settings-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="settings-form">
                    <h4 id="subtitle-modal-salario" data-editable="true">Sal√°rio Base (para c√°lculo)</h4>
                    <div class="form-group">
                         <input type="number" id="baseSalaryInput" placeholder="Ex: 2500.00" step="0.01">
                    </div>
                    <hr>
                    <h4 id="subtitle-modal-metas" data-editable="true">Metas de Cancelamento</h4>
                    <p id="desc-modal-metas" data-editable="true">Defina a quantidade de cancelamentos e a comiss√£o em percentagem (%) do sal√°rio.</p>
                    <div id="settings-metas-container"></div>
                    <hr>
                    <h4 id="subtitle-modal-notificacoes" data-editable="true">Notifica√ß√µes</h4>
                    <div class="form-group" style="display: flex; align-items: center; gap: 15px; justify-content: center;">
                        <input type="checkbox" id="reminderEnabled" style="width: auto;">
                        <label for="reminderEnabled" style="margin: 0;" id="label-modal-lembrete" data-editable="true">Ativar lembrete di√°rio</label>
                        <input type="time" id="reminderTime">
                    </div>
                    <button type="submit" class="button save-button" style="width: 100%; margin-top: 20px;">Guardar Configura√ß√µes</button>
                </form>

                <div class="modal-actions">
                    <button type="button" id="importButton" class="button">Importar Backup</button>
                    <button type="button" id="exportButton" class="button">Exportar Backup</button>
                    <button type="button" id="installAppButton" class="button">Instalar App</button>
                    <button type="button" id="clearCacheButton" class="button reset-button">Limpar Cache</button>
                    <button type="button" id="resetButton" class="button reset-button">Repor Dados da App</button>
                </div>
            </div>
        </div>
    </div>

    <div id="senhas-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="title-modal-senhas" data-editable="true">Senhas de Acesso</h2>
                <span class="close-button" id="close-senhas-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div id="senhas-container">
                    <div class="senha-item"><h4 id="senha-sistema-1" data-editable="true">SIG</h4><p><strong id="senha-label-user-1" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-1" data-editable="true">flavio.cardozo@desktop.tec.br</span></p><p><strong id="senha-label-pass-1" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-1" data-editable="true">Suporte N2</span></p></div>
                    <div class="senha-item"><h4 id="senha-sistema-2" data-editable="true">SalesForce</h4><p><strong id="senha-label-user-2" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-2" data-editable="true">flavio.cardozo@desktop.tec.br</span></p><p><strong id="senha-label-pass-2" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-2" data-editable="true">@Flavero85</span></p></div>
                    <div class="senha-item"><h4 id="senha-sistema-3" data-editable="true">Matrix Chat</h4><p><strong id="senha-label-user-3" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-3" data-editable="true">flavio.cardozo@desktop.tec.br</span></p><p><strong id="senha-label-pass-3" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-3" data-editable="true">Fb5!ji</span></p></div>
                    <div class="senha-item"><h4 id="senha-sistema-4" data-editable="true">SIS</h4><p><strong id="senha-label-user-4" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-4" data-editable="true">flavio.cardozo</span></p><p><strong id="senha-label-pass-4" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-4" data-editable="true">@PSLk869</span></p></div>
                    <div class="senha-item"><h4 id="senha-sistema-5" data-editable="true">ADM</h4><p><strong id="senha-label-user-5" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-5" data-editable="true">flavio.cardozo@desktop.tec.br</span></p><p><strong id="senha-label-pass-5" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-5" data-editable="true">Flavero1609</span></p></div>
                    <div class="senha-item"><h4 id="senha-sistema-6" data-editable="true">LG</h4><p><strong id="senha-label-user-6" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-6" data-editable="true">34792557879</span></p><p><strong id="senha-label-pass-6" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-6" data-editable="true">@Flavero85</span></p></div>
                    <div class="senha-item"><h4 id="senha-sistema-7" data-editable="true">WebMail</h4><p><strong id="senha-label-user-7" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-7" data-editable="true">flavio.cardozo@desktop.tec.br</span></p><p><strong id="senha-label-pass-7" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-7" data-editable="true">eWJBP[ar8V</span></p></div>
                    <div class="senha-item"><h4 id="senha-sistema-8" data-editable="true">NetCore</h4><p><strong id="senha-label-user-8" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-8" data-editable="true">flavio.cardozo@desktop.tec.br</span></p><p><strong id="senha-label-pass-8" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-8" data-editable="true">Flavero1609</span></p></div>
                    <div class="senha-item"><h4 id="senha-sistema-9" data-editable="true">URA</h4><p><strong id="senha-label-user-9" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-9" data-editable="true">agent/11271 9323 RAMAL 2589</span></p><p><strong id="senha-label-pass-9" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-9" data-editable="true">mvjYsE1</span></p></div>
                    <div class="senha-item"><h4 id="senha-sistema-10" data-editable="true">Reserva</h4><p><strong id="senha-label-user-10" data-editable="true">Utilizador:</strong> <span class="copyable-credential" id="senha-user-10" data-editable="true">flavio.cardozo</span></p><p><strong id="senha-label-pass-10" data-editable="true">Senha:</strong> <span class="copyable-credential" id="senha-pass-10" data-editable="true">senha123</span></p></div>
                </div>
            </div>
        </div>
    </div>

    <footer class="app-footer">
        <a href="https://www.flavioitech.com" target="_blank" class="footer-link">
            <img src="logo.png" alt="Logo" class="footer-logo" id="footer-logo-img">
            <span id="footer-site-text" data-editable="true">Meu Site</span>
        </a>
        <a href="https://wa.me/5519998821845" target="_blank" class="footer-link">
            <svg class="footer-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="currentColor"><path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 221.9-99.6 221.9-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.8 0-67.6-9.5-97.8-27.2l-6.9-4.1-72.7 19.1L48.4 358s-4.4-7.2-12.1-99.6c0-11.4 2.9-22.5 8.4-32.9l16.4-30.3c34.9-64.4 106.4-104.1 180.1-104.1 32.5 0 63.8 12.8 86.8 35.7 23 22.9 35.9 54.1 35.9 86.6 0 92.8-74.9 167.8-167.7 167.8zm118.9-194.3c-4.1-2-24.5-12.1-28.4-13.5-3.9-1.4-6.7-2-9.5 2-2.8 4-10.8 13.5-13.2 16.2-2.4 2.8-4.8 3.1-8.9 1.1-4.1-2-17.4-6.4-33.1-20.4-12.2-10.8-20.4-24.1-22.8-28.2-2.4-4.1-.2-6.3 1.8-8.3 1.8-1.8 4.1-4.8 6.1-7.1 2-2.3 2.7-4.1 4.1-6.9 1.4-2.8.7-5.1-1.4-7.1s-9.5-22.8-13-31.1c-3.5-8.3-7.1-7.1-9.5-7.1-2.4 0-5.1 0-7.8 0-2.8 0-7.1 1.1-10.8 5.1-3.7 4-14.2 13.9-14.2 33.9 0 20 14.5 39.3 16.5 41.7 2 2.4 28.4 43.4 69.1 60.9 9.8 4.2 17.5 6.7 23.4 8.6 5.9 1.9 11.2 1.6 15.5 1 4.8-.6 15.1-6.2 17.2-12.1 2.1-5.9 2.1-11 1.4-12.1-0.7-1.1-2.8-1.8-5.9-3.8z"/></svg>
            <span id="footer-whatsapp-text" data-editable="true">19 99882-1845</span>
        </a>
    </footer>
    
    <script type="module" src="script.js"></script>
</body>
</html>
```

### 2. Script do Aplicativo (Vers√£o Est√°vel e sem PIN)

Este √© o `script.js` reestruturado para ser mais robusto e sem a l√≥gica do PIN.

```javascript
// Importa√ß√£o dos m√≥dulos do Firebase 
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
import { getFirestore, doc, getDoc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

// --- INICIALIZA√á√ÉO DO FIREBASE ---
const firebaseConfig = {
  apiKey: "AIzaSyCdQYNKJdTYEeOaejZy_ZxU9tVq7bF1x34",
  authDomain: "app-suporte-n2.firebaseapp.com",
  projectId: "app-suporte-n2",
  storageBucket: "app-suporte-n2.appspot.com",
  messagingSenderId: "257470368604",
  appId: "1:257470368604:web:42fcc4973851eb02b78f99"
};

// --- VARI√ÅVEIS GLOBAIS ---
let app, auth, db, userId = null;
let trendChart, categoryPieChart;

// --- ESTRUTURAS DE DADOS (Estado local) ---
let metas = [], allCases = [], history = [], categoryCounts = {}, unlockedAchievements = {}, dailyLogbook = {};
let baseSalary = 0;
let reminderSettings = { enabled: false, time: '18:00' };
let usedStatuses = new Set(), usedQuickResponses = new Set();
let previousDailyCancellations = 0, dailyCopyCount = 0;
let isEditMode = false;
let deferredInstallPrompt;

// --- CONSTANTES ---
const DAILY_PROTOCOL_GOAL = 50;
const MONTHLY_PROTOCOL_GOAL = 1300;
const TOTAL_WORKING_DAYS = 26;
const MIN_SWIPE_DISTANCE = 50;
const THEMES = ['tech', 'dark', 'light', 'mint', 'sunset', 'graphite'];

// --- FUN√á√ÉO PRINCIPAL E PONTO DE ENTRADA ---
document.addEventListener('DOMContentLoaded', main);

function main() {
    // --- SELETORES DE ELEMENTOS ---
    const loadingOverlay = document.getElementById('loading-overlay');
    const appContainer = document.getElementById('app-container');
    const dailyCancellationsInput = document.getElementById('dailyCancellationsInput');
    const atendimentosInput = document.getElementById('atendimentosInput');
    const protocolosAnalisadosInput = document.getElementById('protocolosAnalisadosInput');
    const incrementProtocolosButton = document.getElementById('incrementProtocolosButton');
    const metasContainer = document.getElementById('metas-container');
    const summaryText = document.getElementById('summary-text');
    const incrementButton = document.getElementById('incrementButton');
    const categorySelect = document.getElementById('categorySelect');
    const categorySummaryList = document.getElementById('category-summary-list');
    const achievementList = document.getElementById('achievement-list');
    const saveButton = document.getElementById('saveButton');
    const resetButton = document.getElementById('resetButton');
    const exportButton = document.getElementById('exportButton');
    const importButton = document.getElementById('importButton');
    const settingsButton = document.getElementById('settings-button');
    const settingsModal = document.getElementById('settings-modal');
    const closeSettingsModal = document.getElementById('close-settings-modal');
    const settingsForm = document.getElementById('settings-form');
    const baseSalaryInput = document.getElementById('baseSalaryInput');
    const settingsMetasContainer = document.getElementById('settings-metas-container');
    const bonusValueEl = document.getElementById('bonus-value');
    const bonusFormulaEl = document.getElementById('bonus-formula');
    const historyListEl = document.getElementById('history-list');
    const projectionValueEl = document.getElementById('projection-value');
    const projectionFormulaEl = document.getElementById('projection-formula');
    const tierProjectionContainer = document.getElementById('tier-projection-container');
    const trendChartCanvas = document.getElementById('trendChart');
    const categoryPieChartCanvas = document.getElementById('categoryPieChart');
    const installAppButton = document.getElementById('installAppButton');
    const toastContainer = document.getElementById('toast-container');
    const editButton = document.getElementById('editButton');
    const respostasContainer = document.getElementById('respostas-container');
    const reminderEnabledInput = document.getElementById('reminderEnabled');
    const reminderTimeInput = document.getElementById('reminderTime');
    const casesListContainer = document.getElementById('cases-list-container');
    const addCaseButton = document.getElementById('addCaseButton');
    const clearCasesButton = document.getElementById('clearCasesButton');
    const caseSearchInput = document.getElementById('case-search-input');
    const caseFilterButtons = document.querySelectorAll('.filter-btn');
    const themeToggleButton = document.getElementById('themeToggleButton');
    const senhasButton = document.getElementById('senhas-button');
    const senhasModal = document.getElementById('senhas-modal');
    const closeSenhasModal = document.getElementById('close-senhas-modal');
    const senhasContainer = document.getElementById('senhas-container');
    const clearCacheButton = document.getElementById('clearCacheButton');
    const dailyMissionList = document.getElementById('daily-mission-list');
    const logbookTextarea = document.getElementById('logbook-textarea');
    const saveLogbookButton = document.getElementById('saveLogbookButton');
    const tabContentWrapper = document.getElementById('tab-content-wrapper');
    const tabsContainer = document.querySelector('.tabs-container');
    const tabButtons = document.querySelectorAll('.tab-button');
    const reportMonthSelect = document.getElementById('report-month-select');
    const exportPdfButton = document.getElementById('export-pdf-button');
    const currentMonthSummaryEl = document.getElementById('current-month-summary');
    const previousMonthComparisonEl = document.getElementById('previous-month-comparison');
    const currentMonthTitleEl = document.getElementById('current-month-title');
    const previousMonthTitleEl = document.getElementById('previous-month-title');

    // --- FUN√á√ïES DE UTILIDADE ---
    const vibrate = () => { if ('vibrate' in navigator) navigator.vibrate(50); };
    function showToast(message, type = 'info') {
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.textContent = message;
        toastContainer.appendChild(toast);
        setTimeout(() => toast.classList.add('show'), 10);
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => toast.remove(), 3000);
        }, 3000);
    }
    const parseDate = (str) => {
        try {
            const [day, month, year] = str.split('/').map(Number);
            return new Date(year, month - 1, day);
        } catch (e) {
            return new Date();
        }
    };
    const getTodayDateString = () => new Date().toLocaleDateString('pt-BR');
    
    // --- L√ìGICA DE CARREGAMENTO E AUTENTICA√á√ÉO ---
    function showLoading(message) {
        loadingOverlay.querySelector('p').textContent = message;
        loadingOverlay.style.display = 'flex';
    }
    function hideLoading() {
        loadingOverlay.style.opacity = '0';
        setTimeout(() => {
            loadingOverlay.style.display = 'none';
        }, 500);
        appContainer.style.visibility = 'visible';
    }

    try {
        app = initializeApp(firebaseConfig);
        auth = getAuth(app);
        db = getFirestore(app);

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                await loadDataFromFirebase();
            } else {
                showLoading("Conectando ao servidor...");
                await signInAnonymously(auth);
            }
        });
    } catch (error) {
        console.error("Falha CR√çTICA ao inicializar o Firebase.", error);
        alert("Erro grave na configura√ß√£o do Firebase. O aplicativo n√£o pode iniciar.");
    }
    
    // --- SINCRONIZA√á√ÉO COM FIREBASE ---
    async function loadDataFromFirebase() {
        if (!userId) { showToast("Erro de autentica√ß√£o.", "danger"); return; }
        showLoading("Sincronizando dados...");
        const docRef = doc(db, "users", userId);
        try {
            const docSnap = await getDoc(docRef);
            if (docSnap.exists()) {
                const data = docSnap.data();
                metas = data.metas || [{ id: 1, target: 10, reward: 0.24 }];
                allCases = data.allCases || [];
                baseSalary = data.baseSalary || 0;
                history = data.history || [];
                categoryCounts = data.categoryCounts || {};
                unlockedAchievements = data.unlockedAchievements || {};
                reminderSettings = data.reminderSettings || { enabled: false, time: '18:00' };
                usedStatuses = new Set(data.usedStatuses || []);
                usedQuickResponses = new Set(data.usedQuickResponses || []);
                dailyLogbook = data.dailyLogbook || {};
            } else {
                metas = [{ id: 1, target: 10, reward: 0.24 }];
            }
        } catch (error) {
            console.error("Erro ao carregar dados do Firestore:", error);
            showToast(`Falha ao carregar dados: ${error.message}`, "danger");
        } finally {
            loadLocalData();
            updateAll();
            hideLoading();
        }
    }

    async function saveDataToFirebase() {
        if (!userId) { showToast("Erro de autentica√ß√£o.", "danger"); return; }
        showLoading("Sincronizando...");
        saveDailyState();
        const dataToSave = {
            metas, allCases, baseSalary, history, categoryCounts,
            unlockedAchievements, reminderSettings, dailyLogbook,
            usedStatuses: Array.from(usedStatuses),
            usedQuickResponses: Array.from(usedQuickResponses),
            lastUpdated: serverTimestamp()
        };
        try {
            await setDoc(doc(db, "users", userId), dataToSave, { merge: true });
            showToast("Progresso sincronizado com a nuvem!", "success");
        } catch (error) {
            console.error("Erro ao salvar dados:", error);
            showToast("Falha ao sincronizar.", "danger");
        } finally {
            hideLoading();
        }
    }
    
    // --- L√ìGICA DE DADOS LOCAIS (Progresso do dia) ---
    function loadLocalData() {
        const todayStr = getTodayDateString();
        const lastUsedDate = localStorage.getItem('lastUsedDate');
        let dailyCount = 0, dailyProtocols = 0;
        dailyCopyCount = 0;

        if (todayStr === lastUsedDate) {
            dailyCount = parseInt(localStorage.getItem('dailyCancellationsCount')) || 0;
            dailyProtocols = parseInt(localStorage.getItem('protocolosAnalisadosCount')) || 0;
            dailyCopyCount = parseInt(localStorage.getItem('dailyCopyCount')) || 0;
        }
        
        dailyCancellationsInput.value = dailyCount;
        protocolosAnalisadosInput.value = dailyProtocols;
        previousDailyCancellations = dailyCount;
        
        localStorage.setItem('lastUsedDate', todayStr);
        const lastHistoryEntry = history.length > 0 ? history[history.length - 1] : { atendimentos: 0 };
        atendimentosInput.value = history.find(h => h.date === todayStr)?.atendimentos || lastHistoryEntry.atendimentos;
        baseSalaryInput.value = baseSalary > 0 ? baseSalary : '';
        reminderEnabledInput.checked = reminderSettings.enabled;
        reminderTimeInput.value = reminderSettings.time;
        logbookTextarea.value = dailyLogbook[todayStr] || '';
    }
    
    function saveDailyState() {
        const date = getTodayDateString();
        const newEntry = { 
            date, 
            atendimentos: parseInt(atendimentosInput.value) || 0,
            dailyCancellations: parseInt(dailyCancellationsInput.value) || 0,
            protocols: parseInt(protocolosAnalisadosInput.value) || 0
        };
        
        const todayIndex = history.findIndex(entry => entry.date === date);
        if (todayIndex > -1) { history[todayIndex] = newEntry; } 
        else { history.push(newEntry); }
        history.sort((a, b) => parseDate(a.date) - parseDate(b.date));
        
        localStorage.setItem('protocolosAnalisadosCount', newEntry.protocols);
        localStorage.setItem('dailyCancellationsCount', newEntry.dailyCancellations);
        localStorage.setItem('dailyCopyCount', dailyCopyCount);
        unlockAchievement('achieve-first-save', 'Primeiro progresso guardado!');
    }
    
    // --- EVENT LISTENERS ---
    saveButton.addEventListener('click', saveDataToFirebase);
    // Adicione aqui todos os outros event listeners do seu aplicativo
    // Exemplo:
    incrementButton.addEventListener('click', () => {
        // ...l√≥gica...
    });
    
    // Todas as outras fun√ß√µes (renderiza√ß√£o, relat√≥rios, etc.) v√£o aqui...
    function updateAll() {
        // ...c√≥digo...
    }
    updateAll(); // Chame para renderizar o estado inicial
}

